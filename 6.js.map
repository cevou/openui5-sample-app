{"version":3,"sources":["webpack:///../node_modules/@openui5/sap.ui.support/src/sap/ui/support/supportRules/ui/IFrameController.js"],"names":["__WEBPACK_UI5_DEFINE_ARRAY__","__WEBPACK_UI5_DEFINE_RESULT__","__webpack_require__","undefined","jQuery","ManagedObject","CommunicationBus","channelNames","constants","sFrameOrigin","sFrameIdentifier","sFrameUrl","oIFrameController","IFrameController","extend","constructor","sap","log","warning","apply","this","arguments","prototype","_setCommunicationSubscriptions","subscribe","ENSURE_FRAME_OPENED","document","getElementById","style","height","resizeFrame","toggleHide","RESIZE_FRAME","aParams","bigger","injectFrame","supportModeConfig","sUrl","frameURI","Date","getModulePath","window","location","protocol","host","URI","replace","communicationWindows","indexOf","supportTool","open","onload","title","SUPPORT_ASSISTANT_NAME","openWindow","toolFrame","createElement","id","src","width","position","left","bottom","border","borderRadius","zIndex","boxShadow","body","appendChild","setInterval","parentNode","nodeName","contentWindow","openFrame","toolFrameStyle","hidden","_originalSize","_stop","_oCssLink","removeChild","_oDomRef","_oCore","getFrameOrigin","getFrameIdentifier","getFrameUrl","exports","module"],"mappings":"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","file":"6.js","sourcesContent":["/*!\n * OpenUI5\n * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.\n * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.\n */\n\nsap.ui.define([\n\t\"jquery.sap.global\",\n\t\"sap/ui/base/ManagedObject\",\n\t\"sap/ui/support/supportRules/WindowCommunicationBus\",\n\t\"sap/ui/support/supportRules/WCBChannels\",\n\t\"sap/ui/support/supportRules/Constants\"\n],\nfunction (jQuery, ManagedObject, CommunicationBus, channelNames, constants) {\n\t\"use strict\";\n\n\tvar oIFrameController = null;\n\n\tvar sFrameOrigin;\n\n\tvar sFrameIdentifier;\n\n\tvar sFrameUrl;\n\n\tfunction computeFrameOrigin(sUrl) {\n\t\tvar frameURI = new window.URI(sUrl);\n\t\tvar sOrigin = ( frameURI.protocol() || window.location.protocol.replace(':', '') ) +\n\t\t\t\t\t\t'://' +\n\t\t\t\t\t\t( frameURI.host() || window.location.host );\n\n\t\treturn sOrigin;\n\t}\n\n\tfunction generateIdentifier() {\n\t\treturn '' + +new Date();\n\t}\n\n\tfunction openFrame(sUrl) {\n\t\tvar toolFrame = document.createElement(\"IFRAME\");\n\t\tvar style = toolFrame.style;\n\n\t\ttoolFrame.id = \"sap-ui-supportToolsFrame\";\n\t\ttoolFrame.src = sUrl;\n\n\t\tstyle.width = \"100%\";\n\t\tstyle.height = \"28px\";\n\t\tstyle.position = \"absolute\";\n\t\tstyle.left = \"0\";\n\t\tstyle.bottom = \"0\";\n\t\tstyle.border = \"none\";\n\t\t// This fixed a visual glitch with the iframe on chrome see BCP 1870314303\n\t\tstyle.borderRadius = \"1px\";\n\t\tstyle.zIndex = \"1001\";\n\t\t// style.transition = \"width 300ms ease-in-out, height 300ms ease-in-out\";\n\t\tstyle.boxShadow = \"1px -10px 42px -4px #888\";\n\n\t\tdocument.body.appendChild(toolFrame);\n\n\t\t// This interval is needed because sometimes an app is placed at\n\t\t// the body element which involves moving everything already there\n\t\t// into a new, hidden DIV element\n\t\tsetInterval(function () {\n\t\t\tif (toolFrame.parentNode.nodeName !== \"BODY\") {\n\t\t\t\tdocument.body.appendChild(toolFrame);\n\t\t\t\twindow.communicationWindows.supportTool = toolFrame.contentWindow;\n\t\t\t}\n\t\t}, 1000);\n\n\t\twindow.communicationWindows.supportTool = toolFrame.contentWindow;\n\t}\n\n\tfunction openWindow(sUrl) {\n\t\twindow.communicationWindows.supportTool = window.open(\n\t\t\tsUrl,\n\t\t\t\"sapUiSupportTool\",\n\t\t\t\"width=1024,height=400,status=no,toolbar=no,menubar=no,resizable=yes,location=no,directories=no,scrollbars=no\"\n\t\t);\n\n\t\twindow.communicationWindows.supportTool.window.onload = function () {\n\t\t\twindow.communicationWindows.supportTool.document.title = constants.SUPPORT_ASSISTANT_NAME;\n\t\t};\n\t}\n\n\tvar IFrameController = ManagedObject.extend(\"sap.ui.support.IFrameController\", {\n\t\tconstructor: function () {\n\t\t\tif (!oIFrameController) {\n\t\t\t\tManagedObject.apply(this, arguments);\n\t\t\t} else {\n\t\t\t\tjQuery.sap.log.warning(\"Only one support tool allowed\");\n\t\t\t\treturn oIFrameController;\n\t\t\t}\n\t\t}\n\t});\n\n\tIFrameController.prototype._setCommunicationSubscriptions = function () {\n\t\tCommunicationBus.subscribe(channelNames.ENSURE_FRAME_OPENED, function () {\n\t\t\tif (document.getElementById(\"sap-ui-supportToolsFrame\").style.height === \"28px\") {\n\t\t\t\tthis.resizeFrame(true);\n\t\t\t\tthis.toggleHide();\n\t\t\t}\n\t\t}, this);\n\n\t\tCommunicationBus.subscribe(channelNames.RESIZE_FRAME, function (aParams) {\n\t\t\toIFrameController.resizeFrame(aParams.bigger);\n\t\t});\n\t};\n\n\tIFrameController.prototype.injectFrame = function (supportModeConfig) {\n\t\tsFrameIdentifier = generateIdentifier();\n\n\t\tsFrameUrl = jQuery.sap.getModulePath(\"sap.ui.support.supportRules.ui\",\n\t\t\t\"/overlay.html?sap-ui-xx-formfactor=compact&sap-ui-xx-support-origin=\" +\n\t\t\twindow.location.protocol + \"//\" + window.location.host + \"&\" +\n\t\t\t\"sap-ui-xx-frame-identifier=\" + sFrameIdentifier);\n\n\t\tsFrameOrigin = computeFrameOrigin(sFrameUrl);\n\n\t\twindow.communicationWindows = window.communicationWindows || {};\n\n\t\tif (supportModeConfig.indexOf(\"window\") > -1) {\n\t\t\topenWindow(sFrameUrl);\n\t\t} else {\n\t\t\topenFrame(sFrameUrl);\n\t\t\tthis._setCommunicationSubscriptions();\n\t\t}\n\t};\n\n\tIFrameController.prototype.resizeFrame = function (bigger) {\n\t\tvar toolFrameStyle = document.getElementById(\"sap-ui-supportToolsFrame\").style;\n\n\t\tif (bigger) {\n\t\t\tif (toolFrameStyle.height === \"50%\") {\n\t\t\t\ttoolFrameStyle.height = \"100%\";\n\t\t\t} else if (toolFrameStyle.height === \"28px\") {\n\t\t\t\ttoolFrameStyle.height = \"50%\";\n\t\t\t}\n\t\t} else {\n\t\t\tif (toolFrameStyle.height === \"100%\") {\n\t\t\t\ttoolFrameStyle.height = \"50%\";\n\t\t\t} else if (toolFrameStyle.height === \"50%\") {\n\t\t\t\ttoolFrameStyle.height = \"28px\";\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\n\t * Toggles frame state between hidden and shown\n\t * Default is shown\n\t *\n\t * @param {boolean} hidden should the frame hide or not\n\t */\n\tIFrameController.prototype.toggleHide = function (hidden) {\n\t\tvar toolFrameStyle = document.getElementById(\"sap-ui-supportToolsFrame\").style;\n\n\t\tif (hidden) {\n\t\t\tthis._originalSize = {\n\t\t\t\twidth: toolFrameStyle.width,\n\t\t\t\theight: toolFrameStyle.height\n\t\t\t};\n\n\t\t\ttoolFrameStyle.width = \"170px\";\n\t\t\ttoolFrameStyle.height = \"28px\";\n\t\t} else {\n\t\t\tif (this._originalSize) {\n\t\t\t\ttoolFrameStyle.width = this._originalSize.width;\n\t\t\t\ttoolFrameStyle.height = this._originalSize.height;\n\t\t\t\tthis._originalSize = null;\n\t\t\t}\n\t\t}\n\t};\n\n\tIFrameController.prototype._stop = function () {\n\t\tthis._oCssLink.parentNode.removeChild(this._oCssLink);\n\t\tthis._oDomRef.parentNode.removeChild(this._oCssLink);\n\t\tthis._oCore = null;\n\t};\n\n\tIFrameController.prototype.getFrameOrigin = function () {\n\t\treturn sFrameOrigin;\n\t};\n\n\tIFrameController.prototype.getFrameIdentifier = function () {\n\t\treturn sFrameIdentifier;\n\t};\n\n\tIFrameController.prototype.getFrameUrl = function () {\n\t\treturn sFrameUrl;\n\t};\n\n\toIFrameController = new IFrameController();\n\n\treturn oIFrameController;\n\n}, true);\n"],"sourceRoot":""}